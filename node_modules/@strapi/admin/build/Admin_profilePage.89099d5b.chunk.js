"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[9497],{94987:function(k,x,a){a.r(x),a.d(x,{default:function(){return me}});var e=a(32735),c=a(36150),S=a(95162),F=a(64092),C=a(56932),Y=a(91779),h=a(77981),P=a(84642),l=a(96192),M=a(40501),y=a(92802),L=a(74758),b=a(67879),R=a(20108),q=a(31557),_=a(23816),$=a(33868),X=a(2846),ee=a(78495),U=a(8365),O=a(10710),u=a(97037),N=a(10364),D=a(62161),ae=a(60216),t=a.n(ae),J=a(8471);const V=(0,J.ZP)(X.o)`
  ::-ms-reveal {
    display: none;
  }
`,H=(0,J.ZP)(ee.E)`
  svg {
    height: ${(0,l.Q1)(16)};
    width: ${(0,l.Q1)(16)};
    path {
      fill: ${({theme:r})=>r.colors.neutral600};
    }
  }
`,B=({errors:r,onChange:d,values:m})=>{const{formatMessage:i}=(0,b.Z)(),[s,T]=(0,e.useState)(!1),[n,A]=(0,e.useState)(!1),[Z,G]=(0,e.useState)(!1);return e.createElement(h.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(P.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(U.Z,{variant:"delta",as:"h2"},i({id:"global.change-password",defaultMessage:"Change password"})),e.createElement(O.r,{gap:5},e.createElement(u.P,{s:12,col:6},e.createElement(X.o,{error:r.currentPassword?i({id:r.currentPassword,defaultMessage:r.currentPassword}):"",onChange:d,value:m.currentPassword,label:i({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:s?"text":"password",endAction:e.createElement(H,{onClick:w=>{w.stopPropagation(),T(v=>!v)},label:i(s?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},s?e.createElement(N.Z,null):e.createElement(D.Z,null))}))),e.createElement(O.r,{gap:5},e.createElement(u.P,{s:12,col:6},e.createElement(V,{error:r.password?i({id:r.password,defaultMessage:r.password}):"",onChange:d,value:m.password,label:i({id:"global.password",defaultMessage:"Password"}),name:"password",type:n?"text":"password",autoComplete:"new-password",endAction:e.createElement(H,{onClick:w=>{w.stopPropagation(),A(v=>!v)},label:i(n?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},n?e.createElement(N.Z,null):e.createElement(D.Z,null))})),e.createElement(u.P,{s:12,col:6},e.createElement(V,{error:r.confirmPassword?i({id:r.confirmPassword,defaultMessage:r.confirmPassword}):"",onChange:d,value:m.confirmPassword,label:i({id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"}),name:"confirmPassword",type:Z?"text":"password",autoComplete:"new-password",endAction:e.createElement(H,{onClick:w=>{w.stopPropagation(),G(v=>!v)},label:i(Z?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},Z?e.createElement(N.Z,null):e.createElement(D.Z,null))})))))};B.propTypes={errors:t().shape({currentPassword:t().string,password:t().string,confirmPassword:t().string}),onChange:t().func,values:t().shape({currentPassword:t().string,password:t().string,confirmPassword:t().string})},B.defaultProps={errors:{},onChange(){},values:{currentPassword:"",password:"",confirmPassword:""}};var te=B,I=a(4987),se=a(23940),re=a.n(se);const Q=({onChange:r,values:d,localeNames:m,allApplicationThemes:i})=>{const{formatMessage:s}=(0,b.Z)(),T=Object.keys(i).filter(n=>i[n]);return e.createElement(h.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(P.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(P.k,{direction:"column",alignItems:"stretch",gap:1},e.createElement(U.Z,{variant:"delta",as:"h2"},s({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})),e.createElement(U.Z,null,s({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:e.createElement(h.x,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales"},s({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"}))}))),e.createElement(O.r,{gap:5},e.createElement(u.P,{s:12,col:6},e.createElement(I.q4,{label:s({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:s({id:"global.select",defaultMessage:"Select"}),hint:s({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{r({target:{name:"preferedLanguage",value:null}})},clearLabel:s({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:d.preferedLanguage,onChange:n=>{r({target:{name:"preferedLanguage",value:n}})}},Object.entries(m).map(([n,A])=>e.createElement(I.ag,{value:n,key:n},A)))),e.createElement(u.P,{s:12,col:6},e.createElement(I.q4,{label:s({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:s({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:s({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:d.currentTheme,onChange:n=>{r({target:{name:"currentTheme",value:n}})}},e.createElement(I.ag,{value:"system"},s({id:"Settings.profile.form.section.experience.mode.option-system-label",defaultMessage:"Use system settings"})),T.map(n=>e.createElement(I.ag,{value:n,key:n},s({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:s({id:n,defaultMessage:re()(n)})}))))))))};Q.propTypes={allApplicationThemes:t().object,onChange:t().func,values:t().shape({preferedLanguage:t().string,currentTheme:t().string}),localeNames:t().object},Q.defaultProps={allApplicationThemes:{},onChange(){},values:{preferedLanguage:null,currentTheme:""},localeNames:{}};var ne=Q;const z=({errors:r,onChange:d,values:m})=>{const{formatMessage:i}=(0,b.Z)();return e.createElement(h.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(P.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(U.Z,{variant:"delta",as:"h2"},i({id:"global.profile",defaultMessage:"Profile"})),e.createElement(O.r,{gap:5},e.createElement(u.P,{s:12,col:6},e.createElement(l.jm,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:r.firstname,onChange:d,value:m.firstname,type:"text",name:"firstname",required:!0})),e.createElement(u.P,{s:12,col:6},e.createElement(l.jm,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:r.lastname,onChange:d,value:m.lastname,type:"text",name:"lastname"})),e.createElement(u.P,{s:12,col:6},e.createElement(l.jm,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:r.email,onChange:d,value:m.email,type:"email",name:"email",required:!0})),e.createElement(u.P,{s:12,col:6},e.createElement(l.jm,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:r.username,onChange:d,value:m.username,type:"text",name:"username"})))))};z.propTypes={errors:t().shape({firstname:t().string,lastname:t().string,username:t().string,email:t().string}),onChange:t().func,values:t().shape({firstname:t().string,lastname:t().string,username:t().string,email:t().string})},z.defaultProps={errors:{},onChange(){},values:{firstname:"",lastname:"",username:"",email:""}};var oe=z,le=a(24346),ie=a(32720),de=le.Ry().shape(ie.Rw),me=()=>{const{changeLocale:r,localeNames:d}=(0,q.nt)(),{setUserDisplayName:m}=(0,l.L7)(),i=(0,R.useQueryClient)(),{formatMessage:s}=(0,b.Z)(),{trackUsage:T}=(0,l.rS)(),n=(0,l.lm)(),{lockApp:A,unlockApp:Z}=(0,l.o1)(),{notifyStatus:G}=(0,c.G)(),{currentTheme:w,themes:v,onChangeTheme:ce}=(0,_.M)(),{get:W,put:ue}=(0,l.kY)();(0,l.go)();const{isLoading:ge,data:j}=(0,R.useQuery)("user",async()=>{const{data:o}=await W("/admin/users/me");return o.data},{onSuccess(){G(s({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){n({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),{isLoading:fe,data:pe}=(0,R.useQuery)(["providers","isSSOLocked"],async()=>{const{data:{data:o}}=await W("/admin/providers/isSSOLocked");return o},{enabled:window.strapi.isEE&&window.strapi.features.isEnabled("sso"),onError(){n({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})}}),he=ge||fe,K=(0,R.useMutation)(async o=>{const{confirmPassword:g,currentTheme:f,...E}=o,{data:p}=await ue("/admin/users/me",E);return{...p.data,currentTheme:o.currentTheme}},{async onSuccess(o){await i.invalidateQueries("user");const{email:g,firstname:f,lastname:E,username:p,preferedLanguage:Te}=o;l.I8.setUserInfo({email:g,firstname:f,lastname:E,username:p,preferedLanguage:Te});const Ae=o.username||(0,$.P)(o.firstname,o.lastname);m(Ae),r(o.preferedLanguage),ce(o.currentTheme),T("didChangeMode",{newMode:o.currentTheme}),n({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},onSettled(){Z()},refetchActive:!0}),{isLoading:we}=K,ve=async(o,{setErrors:g})=>{A();const f=o.username||null;K.mutate({...o,username:f},{onError(E){const p=E?.response?.data;return p?.data?g(p.data):n({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})};if(he)return e.createElement(S.o,{"aria-busy":"true"},e.createElement(L.q,{title:s({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(F.T,{title:s({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),e.createElement(C.D,null,e.createElement(l.dO,null)));const Ee=pe?.isSSOLocked??!1,{email:Pe,firstname:ye,lastname:Se,username:Me,preferedLanguage:Le}=j,Ie={email:Pe,firstname:ye,lastname:Se,username:Me,preferedLanguage:Le,currentTheme:w};return e.createElement(S.o,{"aria-busy":we},e.createElement(L.q,{title:s({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(y.J9,{onSubmit:ve,initialValues:Ie,validateOnChange:!1,validationSchema:de,enableReinitialize:!0},({errors:o,values:g,handleChange:f,isSubmitting:E,dirty:p})=>e.createElement(l.l0,null,e.createElement(F.T,{title:j.username||(0,$.P)(j.firstname,j.lastname),primaryAction:e.createElement(Y.z,{startIcon:e.createElement(M.Z,null),loading:E,type:"submit",disabled:!p},s({id:"global.save",defaultMessage:"Save"}))}),e.createElement(h.x,{paddingBottom:10},e.createElement(C.D,null,e.createElement(P.k,{direction:"column",alignItems:"stretch",gap:6},e.createElement(oe,{errors:o,onChange:f,values:g}),!Ee&&e.createElement(te,{errors:o,onChange:f,values:g}),e.createElement(ne,{allApplicationThemes:v,onChange:f,values:g,localeNames:d})))))))}},32720:function(k,x,a){a.d(x,{YM:function(){return l},Rw:function(){return C}});var e=a(24346),c=a(96192);const S={firstname:e.Z_().trim().required(c.I0.required),lastname:e.Z_(),email:e.Z_().email(c.I0.email).lowercase().required(c.I0.required),username:e.Z_().nullable(),password:e.Z_().min(8,c.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Z_().min(8,c.I0.minLength).oneOf([e.iH("password"),null],"components.Input.error.password.noMatch").when("password",(M,y)=>M?y.required(c.I0.required):y)};var C={...S,currentPassword:e.Z_().when(["password","confirmPassword"],(M,y,L)=>M||y?L.required(c.I0.required):L),preferedLanguage:e.Z_().nullable()},h={roles:e.IX().min(1,c.I0.required).required(c.I0.required)},l=e.Ry().shape({...S,isActive:e.Xg(),...h})}}]);
