"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[302],{86434:function(W,c,e){e.d(c,{F:function(){return p}});var t=e(32735),g=e(96192),L=e(67879),M=e(20108);const p=(y={},O={})=>{const{id:m="",...f}=y,{get:d}=(0,g.kY)(),{locale:C}=(0,L.Z)(),h=(0,g.Xe)(C,{sensitivity:"base"}),{data:l,error:v,isError:o,isLoading:I,refetch:A}=(0,M.useQuery)(["roles",m,f],async()=>{const{data:r}=await d(`/admin/roles/${m??""}`,{params:f});return r},O);return{roles:t.useMemo(()=>{let r=[];return l&&(Array.isArray(l.data)?r=l.data:r=[l.data]),[...r].sort((R,P)=>h.compare(R.name,P.name))},[l,h]),error:v,isError:o,isLoading:I,refetch:A}}},68951:function(W,c,e){e.r(c),e.d(c,{SingleSignOn:function(){return K},default:function(){return Z}});var t=e(32735),g=e(99226),L=e(95162),M=e(64092),p=e(91779),y=e(56932),O=e(84642),m=e(8365),f=e(10710),d=e(97037),C=e(70420),h=e(16773),l=e(40260),v=e(74323),o=e(96192),I=e(40501),A=e(89793),b=e.n(A),r=e(67879),R=e(40986),P=e(25466),x=e(86434),B=e(30305),u=e(24346),F=u.Ry().shape({autoRegister:u.Xg().required(o.I0.required),defaultRole:u.nK().when("autoRegister",(a,n)=>a?n.required(o.I0.required):n.nullable()),ssoLockedRoles:u.IX().nullable().of(u.nK().when("ssoLockedRoles",(a,n)=>a?n.required(o.I0.required):n.nullable()))});const K=()=>{(0,o.go)();const{formatMessage:a}=(0,r.Z)(),n=(0,R.v9)(B._),{isLoading:G,allowedActions:{canUpdate:D,canReadRoles:X}}=(0,o.ss)({...n.settings.sso,readRoles:n.settings.roles.read}),[{formErrors:i,initialData:z,isLoading:H,modifiedData:E,showHeaderButtonLoader:N},,{handleChange:S,handleSubmit:Q}]=(0,P.G)("/admin/providers/options",F,()=>{},["autoRegister","defaultRole","ssoLockedRoles"]),{roles:U,isLoading:Y}=(0,x.F)(void 0,{enabled:X}),$=G||Y||H;return t.createElement(g.A,null,t.createElement(o.SL,{name:"SSO"}),t.createElement(L.o,{tabIndex:-1},t.createElement("form",{onSubmit:Q},t.createElement(M.T,{primaryAction:t.createElement(p.z,{"data-testid":"save-button",disabled:b()(z,E),loading:N,startIcon:t.createElement(I.Z,null),type:"submit",size:"L"},a({id:"global.save",defaultMessage:"Save"})),title:a({id:"Settings.sso.title",defaultMessage:"Single Sign-On"}),subtitle:a({id:"Settings.sso.description",defaultMessage:"Configure the settings for the Single Sign-On feature."})}),t.createElement(y.D,null,$?t.createElement(o.dO,null):t.createElement(O.k,{direction:"column",alignItems:"stretch",gap:4,background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},t.createElement(m.Z,{variant:"delta",as:"h2"},a({id:"global.settings",defaultMessage:"Settings"})),t.createElement(f.r,{gap:4},t.createElement(d.P,{col:6,m:6,s:12},t.createElement(C.s,{"aria-label":"autoRegister","data-testid":"autoRegister",disabled:!D,checked:E.autoRegister,hint:a({id:"Settings.sso.form.registration.description",defaultMessage:"Create new user on SSO login if no account exists"}),label:a({id:"Settings.sso.form.registration.label",defaultMessage:"Auto-registration"}),name:"autoRegister",offLabel:a({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:a({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:s=>{S({target:{name:"autoRegister",value:s.target.checked}})}})),t.createElement(d.P,{col:6,m:6,s:12},t.createElement(h.P,{disabled:!D,hint:a({id:"Settings.sso.form.defaultRole.description",defaultMessage:"It will attach the new authenticated user to the selected role"}),error:i.defaultRole?a({id:i.defaultRole.id,defaultMessage:i.defaultRole.id}):"",label:a({id:"Settings.sso.form.defaultRole.label",defaultMessage:"Default role"}),name:"defaultRole",onChange:s=>{S({target:{name:"defaultRole",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),value:E.defaultRole},U.map(({id:s,name:T})=>t.createElement(l.W,{key:s,value:s.toString()},T)))),t.createElement(d.P,{col:6,m:6,s:12},t.createElement(v.NU,{disabled:!D,hint:a({id:"Settings.sso.form.localAuthenticationLock.description",defaultMessage:"Select the roles for which you want to disable the local authentication"}),error:i.ssoLockedRoles?a({id:i.ssoLockedRoles.id,defaultMessage:i.ssoLockedRoles.id}):"",label:a({id:"Settings.sso.form.localAuthenticationLock.label",defaultMessage:"Local authentication lock-out"}),name:"ssoLockedRoles",onChange:s=>{S({target:{name:"ssoLockedRoles",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),onClear:()=>{S({target:{name:"ssoLockedRoles",emptyArray:[]}})},value:E.ssoLockedRoles||[],withTags:!0},U.map(({id:s,name:T})=>t.createElement(v.ML,{key:s,value:s.toString()},T))))))))))};var Z=()=>{const a=(0,R.v9)(B._);return t.createElement(o.O4,{permissions:a.settings.sso.main},t.createElement(K,null))}}}]);
