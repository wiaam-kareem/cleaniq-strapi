"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[9600],{12584:function(j,k,n){n.d(k,{Z:function(){return B}});var e=n(32735),r=n(1690),M=n(45037),T=n(27947),h=n(8365),P=n(84642),i=n(96192),b=n(60216),t=n.n(b),S=n(67879),N=n(53038),Z=n(77981),V=n(14763),R=n(94997);const I=({tokenName:s,onClickDelete:o,tokenType:m})=>{const{formatMessage:f}=(0,S.Z)(),{trackUsage:g}=(0,i.rS)(),[l,d]=(0,e.useState)(!1),v=()=>{d(!1),g("willDeleteToken",{tokenType:m}),o()};return e.createElement(Z.x,{paddingLeft:1,onClick:y=>y.stopPropagation()},e.createElement(V.h,{onClick:()=>{d(!0)},label:f({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${s}`}),name:"delete",noBorder:!0,icon:e.createElement(R.Z,null)}),e.createElement(i.QH,{onToggleDialog:()=>d(!1),onConfirm:v,isOpen:l}))};I.propTypes={tokenName:t().string.isRequired,onClickDelete:t().func.isRequired,tokenType:t().string.isRequired};var K=I,O=n(10364),W=n(8471);const w={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},J=(0,W.ZP)(i.rU)`
  svg {
    path {
      fill: ${({theme:s})=>s.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:s})=>s.colors.neutral800};
      }
    }
  }
`,C=({tokenName:s,tokenId:o,buttonType:m,children:f})=>{const{formatMessage:g}=(0,S.Z)(),{location:{pathname:l}}=(0,N.k6)();return e.createElement(J,{to:`${l}/${o}`,title:g(w[m],{target:s})},f)};C.propTypes={tokenName:t().string.isRequired,tokenId:t().oneOfType([t().string,t().number]).isRequired,buttonType:t().string,children:t().node.isRequired},C.defaultProps={buttonType:"edit"};var u=C;const p=({tokenName:s,tokenId:o})=>e.createElement(u,{tokenName:s,tokenId:o,buttonType:"read"},e.createElement(O.Z,null));p.propTypes={tokenName:t().string.isRequired,tokenId:t().oneOfType([t().string,t().number]).isRequired};var x=p,D=n(63318);const U=({tokenName:s,tokenId:o})=>e.createElement(u,{tokenName:s,tokenId:o},e.createElement(D.Z,null));U.propTypes={tokenName:t().string.isRequired,tokenId:t().oneOfType([t().string,t().number]).isRequired};var F=U;const c=({permissions:s,headers:o,contentType:m,isLoading:f,tokens:g,onConfirmDelete:l,tokenType:d})=>{const{canDelete:v,canUpdate:y,canRead:A}=s;return e.createElement(i.tM,{headers:o,contentType:m,rows:g,withBulkActions:v||y||A,isLoading:f,onConfirmDelete:l},e.createElement(E,{tokenType:d,permissions:s,onConfirmDelete:l}))};c.propTypes={tokens:t().array,permissions:t().shape({canRead:t().bool,canDelete:t().bool,canUpdate:t().bool}).isRequired,headers:t().arrayOf(t().shape({cellFormatter:t().func,key:t().string.isRequired,metadatas:t().shape({label:t().string.isRequired,sortable:t().bool}).isRequired,name:t().string.isRequired})),contentType:t().string.isRequired,isLoading:t().bool,onConfirmDelete:t().func,tokenType:t().string.isRequired},c.defaultProps={tokens:[],headers:[],isLoading:!1,onConfirmDelete(){}};var B=c;const E=({tokenType:s,permissions:o,rows:m,withBulkActions:f,onConfirmDelete:g})=>{const{canDelete:l,canUpdate:d,canRead:v}=o,[{query:y}]=(0,i.Kx)(),{formatMessage:A}=(0,S.Z)(),[,$]=y?y.sort.split(":"):"ASC",{push:L,location:{pathname:H}}=(0,N.k6)(),{trackUsage:Q}=(0,i.rS)(),Y=m.sort((a,G)=>{const z=a.name.localeCompare(G.name);return $==="DESC"?-z:z});return e.createElement(r.p,null,Y.map(a=>e.createElement(M.Tr,{key:a.id,...(0,i.X7)({fn(){Q("willEditTokenFromList",{tokenType:s}),L(`${H}/${a.id}`)},condition:d})},e.createElement(T.Td,{maxWidth:(0,i.Q1)(250)},e.createElement(h.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0},a.name)),e.createElement(T.Td,{maxWidth:(0,i.Q1)(250)},e.createElement(h.Z,{textColor:"neutral800",ellipsis:!0},a.description)),e.createElement(T.Td,null,e.createElement(h.Z,{textColor:"neutral800"},e.createElement(i.ij,{timestamp:new Date(a.createdAt)}))),e.createElement(T.Td,null,a.lastUsedAt&&e.createElement(h.Z,{textColor:"neutral800"},e.createElement(i.ij,{timestamp:new Date(a.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:A({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]}))),f&&e.createElement(T.Td,null,e.createElement(P.k,{justifyContent:"end"},d&&e.createElement(F,{tokenName:a.name,tokenId:a.id}),!d&&v&&e.createElement(x,{tokenName:a.name,tokenId:a.id}),l&&e.createElement(K,{tokenName:a.name,onClickDelete:()=>g(a.id),tokenType:s}))))))};E.defaultProps={rows:[],withBulkActions:!1},E.propTypes={rows:t().array,permissions:t().shape({canRead:t().bool,canDelete:t().bool,canUpdate:t().bool}).isRequired,onConfirmDelete:t().func.isRequired,tokenType:t().string.isRequired,withBulkActions:t().bool}},49756:function(j,k,n){n.d(k,{Z:function(){return e},f:function(){return r}});const e="api-token",r="transfer-token"},51318:function(j,k,n){n.r(k),n.d(k,{default:function(){return C}});var e=n(32735),r=n(96192),M=n(40986),T=n(30305),h=n(95162),P=n(64092),i=n(56932),b=n(82064),t=n(33348),S=n.n(t),N=n(67879),Z=n(20108),V=n(53038),R=n(49756),I=n(12584),O=[{name:"name",key:"name",metadatas:{label:{id:"Settings.tokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.tokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],w=()=>{(0,r.go)();const{formatMessage:u}=(0,N.Z)(),p=(0,r.lm)(),x=(0,M.v9)(T._),{allowedActions:{canCreate:D,canDelete:U,canUpdate:F,canRead:c}}=(0,r.ss)(x.settings["transfer-tokens"]),{push:B}=(0,V.k6)(),{trackUsage:E}=(0,r.rS)(),{startSection:s}=(0,r.c1)(),o=(0,e.useRef)(s),{get:m,del:f}=(0,r.kY)();(0,e.useEffect)(()=>{o.current&&o.current("transferTokens")},[]),(0,e.useEffect)(()=>{B({search:S().stringify({sort:"name:ASC"},{encode:!1})})},[B]);const g=O.map(a=>({...a,metadatas:{...a.metadatas,label:u(a.metadatas.label)}})),{data:l,status:d,isFetching:v,refetch:y}=(0,Z.useQuery)(["transfer-tokens"],async()=>{E("willAccessTokenList",{tokenType:R.f});const{data:{data:a}}=await m("/admin/transfer/tokens");return E("didAccessTokenList",{number:a.length,tokenType:R.f}),a},{enabled:c,onError(a){a?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?p({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):p({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),A=c&&(d!=="success"&&d!=="error"||d==="success"&&v),$=(0,Z.useMutation)(async a=>{await f(`/admin/transfer/tokens/${a}`)},{async onSuccess(){await y(["transfer-tokens"])},onError(a){a?.response?.data?.data?p({type:"warning",message:a.response.data.data}):a?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?p({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):p({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),L=l&&l?.length>0,H=c&&L,Q=c&&!L&&!D,Y=c&&!L&&D;return e.createElement(h.o,{"aria-busy":A},e.createElement(r.SL,{name:"Transfer Tokens"}),e.createElement(P.T,{title:u({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:u({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:D?e.createElement(r.Qj,{"data-testid":"create-transfer-token-button",startIcon:e.createElement(b.Z,null),size:"S",onClick:()=>E("willAddTokenFromList",{tokenType:R.f}),to:"/settings/transfer-tokens/create"},u({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})):void 0}),e.createElement(i.D,null,!c&&e.createElement(r.ZF,null),H&&e.createElement(I.Z,{permissions:{canRead:c,canDelete:U,canUpdate:F},headers:g,contentType:"trasfer-tokens",rows:l,isLoading:A,onConfirmDelete:a=>$.mutateAsync(a),tokens:l,tokenType:R.f}),Y&&e.createElement(r.dJ,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:e.createElement(r.Qj,{variant:"secondary",startIcon:e.createElement(b.Z,null),to:"/settings/transfer-tokens/create"},u({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"}))}),Q&&e.createElement(r.dJ,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})))},C=()=>{const u=(0,M.v9)(T._);return e.createElement(r.O4,{permissions:u.settings["transfer-tokens"].main},e.createElement(w,null))}}}]);
